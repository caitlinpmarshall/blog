!function(i){var e={};i(document).on("sowsetupformfield",".siteorigin-widget-field-type-icon",(function(n){var t=i(this),o=t.find(".siteorigin-widget-icon-selector"),s=o.find(".siteorigin-widget-icon-icon"),a=t.find(".siteorigin-widget-icon-selector-current"),d=t.find(".so-icon-remove"),c=t.find(".siteorigin-widget-icon-search");if(!t.data("initialized")){a.on("click",(function(){o.slideToggle(),c.val(""),r()})),d.on("click",(function(i){i.preventDefault(),t.find(".siteorigin-widget-active").trigger("click")}));var r=function(){var e=c.val().toLowerCase();""===e?o.find(".siteorigin-widget-icon-icons-icon").show():o.find(".siteorigin-widget-icon-icons-icon").each((function(){var n=i(this),t=n.attr("data-value");-1===(t=t.replace(/-/," ")).indexOf(e)?n.hide():n.show()}))};c.keyup(r).on("change",r);var l=function(){var n=o.find("select.siteorigin-widget-icon-family").val(),t=o.find(".siteorigin-widget-icon-icons");if(void 0!==e[n]){t.empty();var c,l=e[n],g=l.icons;for(var f in l.hasOwnProperty("styles")&&l.styles&&(c=o.find(".siteorigin-widget-icon-family-styles").val()),0===i("#siteorigin-widget-font-"+n).length&&i("<link rel='stylesheet' type='text/css'>").attr("id","siteorigin-widget-font-"+n).attr("href",e[n].style_uri).appendTo("head"),g){var v=g[f],w=v.hasOwnProperty("unicode")?v.unicode:v;if(!v.hasOwnProperty("styles")||-1!==v.styles.indexOf(c)){var y="sow-icon-"+n+(c?" "+c:""),h=n+(c?"-"+c:"")+"-"+f,u=i('<div data-sow-icon="'+w+'"></div>').attr("data-value",h).addClass(y).addClass("siteorigin-widget-icon-icons-icon").on("click",(function(){var e=i(this);e.hasClass("siteorigin-widget-active")?(e.removeClass("siteorigin-widget-active"),s.val(""),a.find("span").hide(),d.hide()):(t.find(".siteorigin-widget-icon-icons-icon").removeClass("siteorigin-widget-active"),e.addClass("siteorigin-widget-active"),s.val(e.data("value")),a.find("span").show().attr("data-sow-icon",e.attr("data-sow-icon")).attr("class","").addClass(y),d.show()),s.trigger("change",{isRendering:!0}),o.slideUp()}));t.append(u),s.val()===h&&(a.find("span").show().attr("data-sow-icon",u.attr("data-sow-icon")).attr("class","").addClass(y),u.addClass("siteorigin-widget-active"))}}t.prepend(t.find(".siteorigin-widget-active")),r()}},g=function(n){var t=o.find("select.siteorigin-widget-icon-family").val(),s=o.find("select.siteorigin-widget-icon-family option:selected").data("icons");if(null!==s&&(e[t]=s),void 0!==t&&""!==t)if(void 0===e[t]){var a=o.find(".siteorigin-widget-icon-icons");a.addClass("loading"),i.getJSON(soWidgets.ajaxurl,{action:"siteorigin_widgets_get_icons",family:o.find("select.siteorigin-widget-icon-family").val()},(function(s){e[t]=s,function(n){var t=o.find("select.siteorigin-widget-icon-family"),s=t.val();if(void 0!==e[s]){var a=o.find(".siteorigin-widget-icon-family-styles");if(!n){a.off("change",l),a.remove();var d=e[s];if(d.hasOwnProperty("styles")&&d.styles){var c="";for(var r in d.styles)c+='<option value="'+r+'">'+d.styles[r]+"</option>";c&&(a=i('<select class="siteorigin-widget-icon-family-styles"></select>').append(c),t.after(a))}}a.on("change",l)}}(n),a.removeClass("loading"),l()}))}else l()};g(!0),o.find("select.siteorigin-widget-icon-family").on("change",(function(){o.find(".siteorigin-widget-icon-icons").empty(),g()})),s.on("change",(function(i,e){e&&e.isRendering||l()})),t.data("initialized",!0)}}))}(jQuery);