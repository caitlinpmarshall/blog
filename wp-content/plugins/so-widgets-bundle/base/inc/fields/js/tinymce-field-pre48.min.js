!function(e){var t=function(i){"undefined"!=typeof tinyMCEPreInit?(tinyMCEPreInit.mceInit.hasOwnProperty("undefined")&&delete tinyMCEPreInit.mceInit[void 0],tinyMCEPreInit.qtInit.hasOwnProperty("undefined")&&delete tinyMCEPreInit.qtInit[void 0],QTags.instances.hasOwnProperty("undefined")&&delete QTags.instances[void 0],e(i).find("> .siteorigin-widget-field-type-tinymce > .siteorigin-widget-tinymce-container").each((function(t,i){var n=e(i),r=n.find("textarea"),a=r.attr("id");if("undefined"!=typeof tinymce){if(a.indexOf("__i__")>-1)return;var o,s=n.data("mceSettings"),c=n.data("widgetIdBase"),d=r.attr("name").replace(/\[\d*\]/g,""),f=/[a-zA-Z0-9-]+(?:\[[a-zA-Z0-9]+\])?\[(.*)\]/.exec(d)[1],g=new RegExp("widget-"+c+"-?.*-"+f.replace(/\]\[/g,"-")+"[-d]*");for(var l in tinyMCEPreInit.mceInit)l.match(g)&&(s=e.extend({},tinyMCEPreInit.mceInit[l],s));var m=tinymce.get(a);null!==m&&("undefined"==typeof vc&&0===n.closest(".vc_active").length&&(o=m.getContent()),m.remove());if(s=e.extend({},s,{selector:"#"+a,setup:function(e){e.on("change",(function(){tinymce.get(a).save(),r.trigger("change"),r.val(window.switchEditors.pre_wpautop(e.getContent()))})),e.on("init",(function(){o&&e.setContent(o)}))}}),tinyMCEPreInit.mceInit[a]=s,n.find("div#wp-"+a+"-wrap").hasClass("tmce-active"))if(e("#"+a).is(":visible"))tinymce.init(tinyMCEPreInit.mceInit[a]);else var u=setInterval((function(){e("#"+a).is(":visible")&&(tinymce.init(tinyMCEPreInit.mceInit[a]),clearInterval(u))}),500)}var v=n.data("qtSettings");v=e.extend({},tinyMCEPreInit.qtInit["siteorigin-widget-input-tinymce-field"],v,{id:a}),tinyMCEPreInit.qtInit[a]=v,n.find(".quicktags-toolbar").remove(),quicktags(tinyMCEPreInit.qtInit[a]),e(this).on("click",(function(t){var i=e(t.target);if(i.hasClass("wp-switch-editor")){var n=i.hasClass("switch-tmce")?"tmce":"html";if("tmce"==n){var o=tinymce.get(a);if(null!=o){var s=r.val();-1!=s.search("<")&&-1==s.search(">")&&(s=s.replace(/</g,""),r.val(s)),o.setContent(window.switchEditors.wpautop(s))}}e(this).find("+ .siteorigin-widget-tinymce-selected-editor").val(n)}}))})),QTags._buttonsInit()):setTimeout((function(){t(i)}),500)};e(document).on("sowsetupform",(function(i){var n=e(i.target);n.is(".siteorigin-widget-field-repeater-item-form")?n.is(":visible")?t(n):n.on("slideToggleOpenComplete",(function(){n.is(":visible")&&(t(n),n.off("slideToggleOpenComplete"))})):t(n)})),e(document).on("sortstop",(function(i,n){n.item.is(".siteorigin-widget-field-repeater-item")?n.item.find("> .siteorigin-widget-field-repeater-item-form").each((function(){t(e(this))})):t(n.item.find(".siteorigin-widget-form"))}))}(jQuery);